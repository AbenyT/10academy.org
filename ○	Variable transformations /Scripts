import pandas as pd

# Load the CSV file
file_path = '/mnt/data/Week1_challenge_data_source(CSV).csv'  # Replace with actual file path
df = pd.read_csv(file_path)

# Inspect the data structure
print(df.head())

# Assuming the columns 'Dur. (ms)' for total duration and 'Total DL (Bytes)', 'Total UL (Bytes)' for data are present
# Convert duration from milliseconds to seconds (if required)
df['Dur. (s)'] = df['Dur. (ms)'] / 1000

# Create a 'Total Data' column which is the sum of 'Total DL (Bytes)' and 'Total UL (Bytes)'
df['Total Data (Bytes)'] = df['Total DL (Bytes)'] + df['Total UL (Bytes)']

# Segment users into decile classes based on the total session duration
df['Decile'] = pd.qcut(df['Dur. (s)'], 10, labels=False)

# Compute the total data per decile class
decile_data = df.groupby('Decile')['Total Data (Bytes)'].sum().reset_index()

# Display the decile classes and their total data
print(decile_data)

# Save the results to a new CSV file
output_path = '/mnt/data/decile_total_data.csv'
decile_data.to_csv(output_path, index=False)
print(f"Decile data saved to {output_path}")
